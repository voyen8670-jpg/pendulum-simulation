<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Kho Th√≠ Nghi·ªám M√¥ Ph·ªèng</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background: #f9f9f9;
      margin: 0;
      padding: 20px;
    }
    h1 {
      color: #333;
    }
    .menu {
      margin: 20px 0;
    }
    .menu button {
      margin: 5px;
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      border-radius: 8px;
      background: #4CAF50;
      color: white;
      cursor: pointer;
    }
    .menu button:hover {
      background: #45a049;
    }
    #canvas-holder {
      margin-top: 20px;
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/p5@1.9.0/lib/p5.min.js"></script>
</head>
<body>
  <h1>Kho Th√≠ Nghi·ªám M√¥ Ph·ªèng</h1>
  <p>Ch·ªçn th√≠ nghi·ªám ƒë·ªÉ b·∫Øt ƒë·∫ßu:</p>
  <div class="menu">
    <button onclick="startExperiment('pendulum')">üîó Con l·∫Øc ƒë∆°n</button>
    <button onclick="startExperiment('freefall')">üîó R∆°i t·ª± do</button>
  </div>
  <div id="canvas-holder"></div>

  <script>
    let currentSketch;

    function startExperiment(type) {
      // Xo√° to√†n b·ªô n·ªôi dung c≈© trong canvas-holder (canvas + n√∫t)
      document.getElementById("canvas-holder").innerHTML = "";

      if (currentSketch) {
        currentSketch.remove();
      }

      if (type === "pendulum") {
        currentSketch = new p5(pendulumSketch, "canvas-holder");
      } else if (type === "freefall") {
        currentSketch = new p5(freefallSketch, "canvas-holder");
      }
    }

    // ---------------- CON L·∫ÆC ----------------
    const pendulumSketch = (p) => {
      let angle, aVel, aAcc, r = 150;
      let g = 0.4;

      p.setup = () => {
        p.createCanvas(400, 400).parent("canvas-holder");
        angle = p.PI / 4;
        aVel = 0;
        aAcc = 0;
      };

      p.draw = () => {
        p.background(220);
        let originX = p.width / 2;
        let originY = 50;
        let bobX = originX + r * p.sin(angle);
        let bobY = originY + r * p.cos(angle);

        aAcc = (-1 * g / r) * p.sin(angle);
        aVel += aAcc;
        aVel *= 0.99; // ma s√°t
        angle += aVel;

        // v·∫Ω d√¢y
        p.stroke(0);
        p.line(originX, originY, bobX, bobY);

        // v·∫Ω qu·∫£ n·∫∑ng
        p.fill(200, 0, 0);
        p.ellipse(bobX, bobY, 40, 40);
      };
    };

    // ---------------- R∆†I T·ª∞ DO ----------------
    const freefallSketch = (p) => {
      let y, v, g = 9.8;
      let start = false;
      let btn;
      let startTime;

      p.setup = () => {
        p.createCanvas(400, 400).parent("canvas-holder");
        y = 50;
        v = 0;

        btn = p.createButton("B·∫Øt ƒë·∫ßu");
        btn.parent("canvas-holder");
        btn.mousePressed(() => {
          start = true;
          y = 50;
          v = 0;
          startTime = p.millis();
        });
      };

      p.draw = () => {
        p.background(220);

        // m·∫∑t ƒë·∫•t
        p.line(0, p.height-50, p.width, p.height-50);

        if (start) {
          let dt = (p.deltaTime / 1000);
          v += g * dt * 30; // scale gia t·ªëc cho d·ªÖ nh√¨n
          y += v * dt;

          if (y > p.height-70) {
            y = p.height-70;
            v = 0;
            start = false;
          }
        }

        // qu·∫£ b√≥ng
        p.fill(50, 100, 200);
        p.ellipse(p.width/2, y, 40, 40);

        // th·ªùi gian
        if (startTime) {
          let t = (p.millis() - startTime) / 1000;
          p.fill(0);
          p.textSize(16);
          p.text("Th·ªùi gian: " + t.toFixed(2) + "s", 10, 20);
        }
      };
    };
  </script>
</body>
</html>
